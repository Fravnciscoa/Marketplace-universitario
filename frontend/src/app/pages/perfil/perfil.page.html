<!-- üîµ HEADER GLOBAL ‚Äî BARRA COMPLETA -->
<ion-header class="topbar">
  <div class="navbar">

    <!-- Logo + T√≠tulo -->
    <div class="nav-left">
      <img src="assets/icon/Escudo_PUCV-2016__Perfil Redes TW_FB.png" class="logo" />
      <span class="brand">MarketPlace</span>
    </div>

    <!-- Center Navigation -->
    <div class="nav-center">
      <a routerLink="/home" routerLinkActive="active">Inicio</a>
      <a routerLink="/categorias" routerLinkActive="active">Categor√≠as</a>
      <a routerLink="/carrito" routerLinkActive="active">
        <ion-icon name="cart-outline"></ion-icon> Carrito
      </a>
      <a routerLink="/perfil" routerLinkActive="active">Perfil</a>
    </div>

    <!-- Right Side -->
    <div class="nav-right">
      <ion-button routerLink="/publicar" color="primary">
        <ion-icon slot="start" name="add-outline"></ion-icon>
        Publicar
      </ion-button>

      <ion-button routerLink="/auth" color="danger" fill="solid">
        <ion-icon slot="start" name="log-out-outline"></ion-icon>
        Cerrar Sesi√≥n
      </ion-button>
    </div>
  </div>
</ion-header>



<ion-content class="ion-padding">
  <!-- MODO VISUALIZACI√ìN -->
 <!-- MODO VISUALIZACI√ìN -->
<div *ngIf="!editMode" class="perfil-wrapper">

  <div class="perfil-header-card">
    <img src="assets/avatar/4794936.png" class="avatar-large"/>

    <h2 class="perfil-nombre">{{ user.nombre || 'Sin nombre' }}</h2>
    <span class="perfil-rol">Estudiante</span>

    <ion-badge color="success" class="perfil-status">Activo</ion-badge>

    <p class="perfil-carrera">{{ user.carrera || 'Ingenier√≠a en Inform√°tica' }}</p>
  </div>

  <ion-card class="info-card">
    <ion-card-content>
      <div class="info-row">
        <span class="label">Correo</span>
        <span class="value">{{ user.correo || 'No especificado' }}</span>
      </div>

      <div class="info-row">
        <span class="label">Usuario</span>
        <span class="value">{{ user.usuario || 'No especificado' }}</span>
      </div>

      <div class="info-row">
        <span class="label">RUT</span>
        <span class="value">{{ user.rut || 'No especificado' }}</span>
      </div>

      <div class="info-row">
        <span class="label">Regi√≥n</span>
        <span class="value">{{ user.region || 'No especificado' }}</span>
      </div>

      <div class="info-row">
        <span class="label">Comuna</span>
        <span class="value">{{ user.comuna || 'No especificado' }}</span>
      </div>

      <div class="info-row">
        <span class="label">G√©nero</span>
        <span class="value">{{ user.genero || 'No especificado' }}</span>
      </div>

      <div class="info-row">
        <span class="label">Fecha Nac.</span>
        <span class="value">{{ user.fecha_nacimiento || 'No especificado' }}</span>
      </div>

      <div class="info-row">
        <span class="label">Tel√©fono</span>
        <span class="value">{{ user.telefono1 || 'No especificado' }}</span>
      </div>

      <div class="info-row" *ngIf="user.direccion">
        <span class="label">Direcci√≥n</span>
        <span class="value">{{ user.direccion }}</span>
      </div>

      <div class="info-row">
        <span class="label">Miembro desde</span>
        <span class="value">{{ user.fecha_creacion | date:'dd/MM/yyyy' }}</span>
      </div>

      <ion-button expand="block" (click)="activarModoEdicion()" class="edit-btn">
        <ion-icon slot="start" name="create-outline"></ion-icon>
        Editar Perfil
      </ion-button>
    </ion-card-content>
  </ion-card>
</div>


  <!-- MODO EDICI√ìN -->
  <div *ngIf="editMode" class="edicion-container">
    <ion-card>
      <ion-card-header>
        <ion-card-title>Editar Perfil</ion-card-title>
        <ion-card-subtitle>Actualiza tu informaci√≥n personal</ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <form (ngSubmit)="guardarCambios()">
          <ion-item>
            <ion-label position="floating">Nombre Completo *</ion-label>
            <ion-input type="text" [(ngModel)]="user.nombre" name="nombre" required></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">RUT</ion-label>
            <ion-input type="text" [(ngModel)]="user.rut" name="rut" placeholder="12.345.678-9"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">Regi√≥n</ion-label>
            <ion-select [(ngModel)]="user.region" name="region" placeholder="Selecciona tu regi√≥n">
              <ion-select-option value="Valpara√≠so">Valpara√≠so</ion-select-option>
              <ion-select-option value="Metropolitana">Metropolitana</ion-select-option>
              <ion-select-option value="Biob√≠o">Biob√≠o</ion-select-option>
              <ion-select-option value="Otra">Otra</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="floating">Comuna</ion-label>
            <ion-input type="text" [(ngModel)]="user.comuna" name="comuna" placeholder="Ej: Vi√±a del Mar"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">G√©nero</ion-label>
            <ion-select [(ngModel)]="user.genero" name="genero">
              <ion-select-option value="masculino">Masculino</ion-select-option>
              <ion-select-option value="femenino">Femenino</ion-select-option>
              <ion-select-option value="otro">Otro</ion-select-option>
              <ion-select-option value="prefiero_no_decir">Prefiero no decir</ion-select-option>
            </ion-select>
          </ion-item>

          <ion-item>
            <ion-label position="floating">Fecha de Nacimiento</ion-label>
            <ion-input type="date" [(ngModel)]="user.fecha_nacimiento" name="fecha_nacimiento"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">Tel√©fono Principal</ion-label>
            <ion-input type="tel" [(ngModel)]="user.telefono1" name="telefono1" placeholder="+56 9 1234 5678"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">Tel√©fono Secundario (opcional)</ion-label>
            <ion-input type="tel" [(ngModel)]="user.telefono2" name="telefono2"></ion-input>
          </ion-item>

          <ion-item>
            <ion-label position="floating">Direcci√≥n</ion-label>
            <ion-textarea [(ngModel)]="user.direccion" name="direccion" rows="2" placeholder="Calle, n√∫mero, depto"></ion-textarea>
          </ion-item>

          <div class="botones-edicion">
            <ion-button expand="block" type="submit" color="success" class="boton-guardar">
              <ion-icon slot="start" name="checkmark-circle-outline"></ion-icon>
              Guardar Cambios
            </ion-button>

            <ion-button expand="block" fill="outline" color="medium" (click)="cancelarEdicion()" class="boton-cancelar">
              <ion-icon slot="start" name="close-circle-outline"></ion-icon>
              Cancelar
            </ion-button>
          </div>
        </form>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
