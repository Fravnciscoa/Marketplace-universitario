<ion-header>
  <ion-toolbar>
    <ion-back-button defaultHref="/home" slot="start"></ion-back-button>
    <ion-title>MarketPUCV</ion-title>
    <ion-icon name="cart-outline" slot="end" style="margin-right: 20px;"></ion-icon>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Loading spinner -->
  <div *ngIf="isLoading" style="display: flex; justify-content: center; align-items: center; height: 100vh;">
    <ion-spinner name="crescent" color="primary"></ion-spinner>
  </div>

  <!-- Contenido del producto -->
  <div *ngIf="!isLoading && producto">
    <!-- Imagen -->
    <div class="producto-header">
      <img [src]="producto.imagen" [alt]="producto.titulo" class="producto-imagen" />
    </div>

    <!-- Información principal -->
    <ion-card class="producto-info">
      <ion-card-header>
        <ion-card-title class="precio">{{ formatearPrecio(producto.precio) }}</ion-card-title>
        <ion-card-subtitle class="rating">(4.5 ⭐)</ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <!-- Título -->
        <h2 class="titulo-producto">{{ producto.titulo }}</h2>

        <!-- Descripción -->
        <ion-item lines="none">
          <ion-label class="descripcion-label">
            <p class="label-small">Descripción:</p>
            <p class="descripcion-texto">{{ producto.descripcion }}</p>
          </ion-label>
        </ion-item>

        <!-- Nota de precio -->
        <p class="nota-precio">Precio conversable.</p>

        <!-- Botones de acción -->
        <ion-button expand="block" color="primary" (click)="comprar()" class="btn-comprar">
          COMPRAR AHORA
        </ion-button>

        <ion-button
          expand="block"
          fill="outline"
          color="primary"
          (click)="contactarVendedor()"
          class="btn-secundario"
        >
          <ion-icon name="chatbubble-outline" slot="start"></ion-icon>
          CONTACTAR VENDEDOR
        </ion-button>

        <ion-button
          expand="block"
          fill="outline"
          color="primary"
          (click)="toggleFavorite()"
          class="btn-secundario"
        >
          <ion-icon [name]="isFavorite ? 'heart' : 'heart-outline'" slot="start"></ion-icon>
          {{ isFavorite ? 'FAVORITO' : 'AGREGAR FAVORITO' }}
        </ion-button>
      </ion-card-content>
    </ion-card>

    <!-- Información adicional -->
    <ion-card class="info-adicional">
      <ion-card-header>
        <ion-card-title>Información adicional</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <ion-item lines="none">
          <ion-label>
            <p class="label-small">Categoría:</p>
            <p class="valor">{{ producto.categoria }}</p>
          </ion-label>
        </ion-item>

        <ion-item lines="none">
          <ion-label>
            <p class="label-small">Campus:</p>
            <p class="valor">{{ producto.campus }}</p>
          </ion-label>
        </ion-item>

        <ion-item lines="none">
          <ion-label>
            <p class="label-small">Publicado:</p>
            <p class="valor">{{ producto.created_at | date: 'short' }}</p>
          </ion-label>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <!-- Vendedor -->
    <ion-card class="info-vendedor">
      <ion-card-header>
        <ion-card-title>Vendedor</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <ion-item lines="none">
          <ion-icon name="person-circle-outline" slot="start" style="font-size: 50px; color: #003366;"></ion-icon>
          <ion-label>
            <p class="vendedor-nombre">Usuario del Marketplace</p>
            <p class="vendedor-rating">⭐ 4.8 (45 valoraciones)</p>
          </ion-label>
        </ion-item>
      </ion-card-content>
    </ion-card>
  </div>

  <!-- Error -->
  <div *ngIf="!isLoading && !producto" style="padding: 40px; text-align: center;">
    <p>No se pudo cargar el producto</p>
  </div>
</ion-content>
